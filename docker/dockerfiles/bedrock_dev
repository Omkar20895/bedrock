from bedrock_base

RUN pip install --no-cache-dir -r requirements/docker-dev.txt

ENV PATH=/node_modules/.bin:$PATH
ENV PIPELINE_LESS_BINARY=lessc
ENV PIPELINE_SASS_BINARY=node-sass
ENV PIPELINE_YUGLIFY_BINARY=yuglify

COPY ./node_modules /
COPY package.json /
COPY lockdown.json /
# --unsafe-perm required for lockdown to function
RUN cd / && npm install
RUN npm install -g gulp-cli

# Change User
# No USER directive since supervisor is set to run processes as webdev
RUN chown webdev.webdev -R .

CMD ["gulp"]
